# Physics Simulator

## introduction

A range of models have been developed to simulate parafoil dynamics, each varying
in complexity and fidelity. Early work in the 1970s by Godrick introduced a 3-degreeof-freedom (3-DoF) model based on experimental data to describe the longitudinal motion of a parafoil [3]. Since then, both 3- and 4-DoF models have been widely used
to support guidance, navigation, and control (GNC) applications [4], [5]. By modelling
lower-order models, only fundamental aspects of motion are captured and are
insufficient for accurately simulating the full dynamics and response of a parafoil
system for detailed control purposes. To address these limitations, more
comprehensive 6-degree-of-freedom (6-DoF) models have been extensively employed
[6]. This typically represents the parafoil and payload as a single rigid body, tracking
Euler angle orientation and three-dimensional position relative to the intended point of
impact (IPI).

The apparent mass describes the additional inertial forces arising from a body’s
movement through a fluid medium [7]. Due to a parafoils low weight, parafoils are
particularly sensitive to this. Whilst this improves accuracy, it shifts the moment of
inertia outside the longitudinal plane of symmetry requiring this matrix to be computed
at every time step, adding computation cost [8]. Tonglia at el. [9] compared models
with and without apparent mass and observed noticeable differences in steady-state
roll and pitch angles, particularly during manoeuvring. However, the model also
excluded the moment generated by aerodynamic forces, which likely influenced these
discrepancies. Despite these differences in orientation, positional trajectories remained
largely consistent across models.

More sophisticated models extend to 8 and 9-DoF representations, incorporating
relative motion between the canopy and payload [9], [10] [11] as well as structural
dynamics such as suspension line elasticity and joint mechanics [12]. Toglia et al. [9]
demonstrated that such effects introduced notable discrepancies between simpler and
higher-fidelity models, particularly in dynamic conditions, largely attributed to the
coupling between the payload dynamics and the parafoil. While these high-order
models improve accuracy, their nonlinearity and computational cost make them
unsuitable for real-time GNC.

A common approach to simplify the model is linearisation [13], [14]. By assuming near-
constant local air velocity around the parafoil, the system can be treated as quasi-static,
allowing the use of a reduced state vector. Linearisation techniques such as the
Observer/Kalman Filter Identification (OKID) method have been successfully applied
to 8-DoF models, yielding adequate performance [15]. Pena et al. [16] employed a
Genetic Algorithm (GA) to identify the parameter matrix for the time-invariant linear
model of an aircraft’s longitudinal dynamics using only 66 data samples. The GA
converged within 22 minutes, achieving a mean squared error (MSE) of 4.39 × 10⁻⁴ m2
compared to the original complex nonlinear model, demonstrating that linearisation can
maintain the accuracy.

A major challenge in constructing physics models lies in the number of required
aerodynamic coefficients. Forces such as the lift and drag, as well as the moments
about the roll, pitch, and yaw axes, depend on variables like angle of attack, sideslip
angle and vehicle orientation. Each is characterised by an additional coefficient,
leading to approximately 14 distinct coefficients for some 6-DoF models [17].
Consequently, Ward et al. [18] laterally split the parafoil wing up into segments and
only considered the lift and drag forces, reducing the number of coefficients down to 8.
The lateral and rotational motion of the parafoil arose from the different orientation and
displacements of each segment when considering the parafoil as a whole. Validation
against flight data showed this approach could accurately predict core parafoil
behaviour.

An alternative to physics-based modelling is to train black-box models directly on flight
data. These models bypass the assumptions required by physical equations. Li et al.
[19] for example, trained a specialised neural network for non-linear systems on
simulated airdrop data. Results showed that black box model had a lower average error
compared to a previous 6-DoF model previously developed. However, a thorough
understanding of system cannot be attained from this method. In addition, as flight data
is required, this defeats the purpose of using a simulation to estimate flight
performance.

Despite extensive literature on general parafoil systems, studies specifically modelling
a rocket as a payload remain limited. Due to their elongated shape, rockets typically
exhibit a lower centre of pressure and centre of mass compared to the compact
payloads usually typically considered. Consequently, this can induce significant
oscillatory behaviour [20], consistent with observations from drop tests conducted by
Aenishanslin et al. [21], who reported oscillations around 1.5 Hz in the suspended
rocket payload beneath the parafoil making lower fidelity 6-DoF models less accurate.

## Model derivation

## implementation

The above is implemented in *six_DoF_simulator.py*. It consists of the *ParafoilSimulation_6Dof* Class which houses all of the parameters and methods which are outlined above.

Note this class only deals with the physics so basically just the maths. It doesn't run a simulation. Look at the examples below to get an idea of how to use this to actaully run a simulation.

## examples


## reference

::: minos.physics.six_DoF_simulator
